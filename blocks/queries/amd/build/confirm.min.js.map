{"version":3,"file":"confirm.min.js","sources":["../src/confirm.js"],"sourcesContent":["/**\n *\n * @module     block_queries\n * @package\n * @copyright  2022\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n define(['jquery', 'core/modal_factory', 'core/str', 'core/modal_events', 'core/ajax', 'core/notification'],\n  function($, ModalFactory, String, ModalEvents, Ajax, Notification) {\n    var trigger = $('.local_message_delete_button');\n    ModalFactory.create({\n        type: ModalFactory.types.SAVE_CANCEL,\n        title: String.get_string('deletequery', 'block_queries'),\n        body: String.get_string('deletequeryconfirm', 'block_queries'),\n        preShowCallback: function(triggerElement, modal) {\n            // Do something before we show the delete modal.\n            triggerElement = $(triggerElement);\n\n            let classString = triggerElement[0].classList[0]; // local_messageid13\n            // let queryid = classString.substr(classString.lastIndexOf('local_queryid') + 'local_queryid'.length);\n            let responseid = classString.substr(classString.lastIndexOf('local_responseid') + 'local_responseid'.length);\n            // Set the message id in this modal.\n            if(responseid){\n                modal.params = {'responseid': responseid};\n            }\n\n            modal.setSaveButtonText(String.get_string('deletequerybtn', 'block_queries'));\n        },\n        large: false,\n    }, trigger)\n        .done(function(modal) {\n            // Do what you want with your new modal.\n            modal.getRoot().on(ModalEvents.save, function(e) {\n                // Stop the default save button behaviour which is to close the modal.\n                e.preventDefault();\n\n                let footer = Y.one('.modal-footer');\n                footer.setContent(String.get_string('deleting', 'block_queries'));\n                let spinner = M.util.add_spinner(Y, footer);\n                spinner.show();\n                let request = {\n                    methodname: 'block_queries_delete_query',\n                    args: modal.params,\n                };\n                Ajax.call([request])[0].done(function(data) {\n                    modal.hide();\n                    window.location.reload();\n                }).fail(Notification.exception);\n            });\n        });\n\n            var trigger = $('.local_message_delete_response');\n            ModalFactory.create({\n                type: ModalFactory.types.SAVE_CANCEL,\n                title: String.get_string('deletequery', 'block_queries'),\n                body: String.get_string('deleteresponseconfirm', 'block_queries'),\n                preShowCallback: function(triggerElement, modal) {\n                    // Do something before we show the delete modal.\n                    triggerElement = $(triggerElement);\n\n                    let classString = triggerElement[0].classList[0]; // local_messageid13\n                    let queryid = classString.substr(classString.lastIndexOf('local_queryid') + 'local_queryid'.length);\n                    // let responseid = classString.substr(classString.lastIndexOf('local_responseid') + 'local_responseid'.length);\n                    // Set the message id in this modal.\n                    if(queryid){\n                        modal.params = {'queryid': queryid};\n                    }\n                    modal.setSaveButtonText(String.get_string('deletequerybtn', 'block_queries'));\n                },\n                large: false,\n            }, trigger)\n                .done(function(modal) {\n                    // Do what you want with your new modal.\n                    modal.getRoot().on(ModalEvents.save, function(e) {\n                        // Stop the default save button behaviour which is to close the modal.\n                        e.preventDefault();\n\n                        let footer = Y.one('.modal-footer');\n                        footer.setContent(String.get_string('deleting', 'block_queries'));\n                        let spinner = M.util.add_spinner(Y, footer);\n                        spinner.show();\n                        let request = {\n                            methodname: 'block_queries_delete_responce',\n                            args: modal.params,\n                        };\n                        Ajax.call([request])[0].done(function(data) {\n                            modal.hide();\n                            window.location.reload();\n                        }).fail(Notification.exception);\n                    });\n                });\n        });\n"],"names":["define","$","ModalFactory","String","ModalEvents","Ajax","Notification","trigger","create","type","types","SAVE_CANCEL","title","get_string","body","preShowCallback","triggerElement","modal","classString","classList","responseid","substr","lastIndexOf","length","params","setSaveButtonText","large","done","getRoot","on","save","e","preventDefault","footer","Y","one","setContent","M","util","add_spinner","show","request","methodname","args","call","data","hide","window","location","reload","fail","exception","queryid"],"mappings":";;;;;;;AAOCA,+BAAO,CAAC,SAAU,qBAAsB,WAAY,oBAAqB,YAAa,sBACrF,SAASC,EAAGC,aAAcC,OAAQC,YAAaC,KAAMC,kBAC/CC,QAAUN,EAAE,gCAChBC,aAAaM,OAAO,CAChBC,KAAMP,aAAaQ,MAAMC,YACzBC,MAAOT,OAAOU,WAAW,cAAe,iBACxCC,KAAMX,OAAOU,WAAW,qBAAsB,iBAC9CE,gBAAiB,SAASC,eAAgBC,WAIlCC,aAFJF,eAAiBf,EAAEe,iBAEc,GAAGG,UAAU,GAE1CC,WAAaF,YAAYG,OAAOH,YAAYI,YAAY,oBAAsB,mBAAmBC,QAElGH,aACCH,MAAMO,OAAS,YAAeJ,aAGlCH,MAAMQ,kBAAkBtB,OAAOU,WAAW,iBAAkB,mBAEhEa,OAAO,GACRnB,SACEoB,MAAK,SAASV,OAEXA,MAAMW,UAAUC,GAAGzB,YAAY0B,MAAM,SAASC,GAE1CA,EAAEC,qBAEEC,OAASC,EAAEC,IAAI,iBACnBF,OAAOG,WAAWjC,OAAOU,WAAW,WAAY,kBAClCwB,EAAEC,KAAKC,YAAYL,EAAGD,QAC5BO,WACJC,QAAU,CACVC,WAAY,6BACZC,KAAM1B,MAAMO,QAEhBnB,KAAKuC,KAAK,CAACH,UAAU,GAAGd,MAAK,SAASkB,MAClC5B,MAAM6B,OACNC,OAAOC,SAASC,YACjBC,KAAK5C,aAAa6C,iBAIrB5C,QAAUN,EAAE,kCAChBC,aAAaM,OAAO,CAChBC,KAAMP,aAAaQ,MAAMC,YACzBC,MAAOT,OAAOU,WAAW,cAAe,iBACxCC,KAAMX,OAAOU,WAAW,wBAAyB,iBACjDE,gBAAiB,SAASC,eAAgBC,WAIlCC,aAFJF,eAAiBf,EAAEe,iBAEc,GAAGG,UAAU,GAC1CiC,QAAUlC,YAAYG,OAAOH,YAAYI,YAAY,iBAAmB,gBAAgBC,QAGzF6B,UACCnC,MAAMO,OAAS,SAAY4B,UAE/BnC,MAAMQ,kBAAkBtB,OAAOU,WAAW,iBAAkB,mBAEhEa,OAAO,GACRnB,SACEoB,MAAK,SAASV,OAEXA,MAAMW,UAAUC,GAAGzB,YAAY0B,MAAM,SAASC,GAE1CA,EAAEC,qBAEEC,OAASC,EAAEC,IAAI,iBACnBF,OAAOG,WAAWjC,OAAOU,WAAW,WAAY,kBAClCwB,EAAEC,KAAKC,YAAYL,EAAGD,QAC5BO,WACJC,QAAU,CACVC,WAAY,gCACZC,KAAM1B,MAAMO,QAEhBnB,KAAKuC,KAAK,CAACH,UAAU,GAAGd,MAAK,SAASkB,MAClC5B,MAAM6B,OACNC,OAAOC,SAASC,YACjBC,KAAK5C,aAAa6C"}