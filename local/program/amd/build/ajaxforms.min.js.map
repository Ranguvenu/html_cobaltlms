{"version":3,"file":"ajaxforms.min.js","sources":["../src/ajaxforms.js"],"sourcesContent":["/**\n * Add a create new group modal to the page.\n *\n * @module     core_group/AjaxForms\n * @class      AjaxForms\n * @package\n * @copyright  2022 eAbyas Info Solutions\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery',\n        'core/str',\n        'core/modal_factory',\n        'core/modal_events',\n        'core/fragment',\n        'core/ajax',\n        'core/yui',\n        'core/templates',\n        'local_program/select2',\n        'local_program/program'],\n        function($, Str, ModalFactory, ModalEvents, Fragment, Ajax, Y, Templates, select2, program) {\n\n    /**\n     * Constructor\n     * @param {object} args\n     * Each call to init gets it's own instance of this class.\n     */\n   var programlastchildpopup = function(args) {\n            $.ajax({\n                type: \"POST\",\n                url:   M.cfg.wwwroot + '/local/program/ajax.php',\n                data: { programid: args.id, action:'programlastchildpopup',\n                    sesskey: M.cfg.sesskey\n                },\n                success: function(returndata) {\n                    //Var returned_data is ONLY available inside this fn!\n                    ModalFactory.create({\n                        title: Str.get_string('program_info', 'local_program'),\n                        body: returndata\n                      }).done(function(modal) {\n                        // Do what you want with your new modal.\n                        modal.show();\n                         modal.setLarge();\n                         modal.getRoot().addClass('openLMStransition');\n                            modal.getRoot().animate({\"right\":\"0%\"}, 500);\n                            modal.getRoot().on(ModalEvents.hidden, function() {\n                            modal.getRoot().animate({\"right\":\"-85%\"}, 500);\n                                    setTimeout(function(){\n                                    modal.destroy();\n                                }, 1000);\n                            }.bind(this));\n                            $(\".close\").click(function(){\n                                window.location.href =  window.location.href + String();\n                            });\n                      });\n                }\n            });\n    };\n    var AjaxForms = function(args) {\n        this.contextid = args.contextid;\n        this.args = args;\n        this.init(args);\n    };\n    /**\n     * @var {Modal} modal\n     * @private\n     */\n    AjaxForms.prototype.modal = null;\n    /**\n     * @var {int} contextid\n     * @private\n     */\n    AjaxForms.prototype.contextid = -1;\n    /**\n     * Initialise the class.\n     *\n     * @param {object} args used to find triggers for the new group modal.\n     * @private\n     * @return {Promise}\n     */\n    AjaxForms.prototype.init = function(args) {\n        // Fetch the title string.\n        var header_label;\n        var self = this;\n            switch (args.callback) {\n                case 'program_form':\n                    switch (args.id) {\n                        case 0:\n                            header_label = {key:'createprogram', component:'local_program'};\n                        break;\n                        default:\n                            header_label = {key:'updateprogram', component:'local_program'};\n                        break;\n                    }\n                break;\n                case 'session_form':\n                    switch (args.id) {\n                        case 0:\n                            header_label = {key:'addsession', component:'local_program'};\n                        break;\n                        default:\n                            header_label = {key:'updatesession', component:'local_program'};\n                        break;\n                    }\n                break;\n                case 'course_form':\n                    switch (args.id) {\n                        case 0:\n                            header_label = {key:'addcourses', component:'local_program', param:args.programname};\n                        break;\n                        default:\n                            header_label = {key:'updatecourses', component:'local_program'};\n                        break;\n                    }\n                break;\n                case 'program_completion_form':\n                    header_label = {key:'program_completion_settings', component:'local_program'};\n                break;\n                case 'program_curriculum_form':\n                    header_label = {key:'program_curriculum', component:'local_program'};\n                break;\n                case 'program_managelevel_form':\n                    switch (args.id) {\n                         case 0:\n                              header_label = {key:'addsemester', component:'local_program'};\n                         break;\n                         default:\n                              header_label = {key:'updatelevel', component:'local_program'};\n                         break;\n                    }\n\n            }\n        var customstrings = Str.get_strings([header_label,{\n                        key: 'savecontinue',\n                        component: 'local_program'\n                    },\n                    {\n                        key: 'assign',\n                        component: 'local_program'\n                    },\n                    {\n                        key: 'save',\n                        component: 'local_program'\n                    },\n                    {\n                        key: 'previous',\n                        component: 'local_program'\n                    },\n                    {\n                        key: 'skip',\n                        component: 'local_program'\n                    },\n                    {\n                        key: 'cancel',\n                        component: 'local_program'\n                    }]);\n\n        return customstrings.then(function(strings) {\n            // Create the modal.\n            return ModalFactory.create({\n                type: ModalFactory.types.DEFAULT,\n                title: strings[0],\n                body: this.getBody(),\n                footer: this.getFooter(strings),\n            });\n        }.bind(this)).then(function(modal) {\n            // Keep a reference to the modal.\n            this.modal = modal;\n\n            // Forms are big, we want a big modal.\n            this.modal.setLarge();\n\n            this.modal.getRoot().addClass('openLMStransition local_program');\n\n            // We want to reset the form every time it is opened.\n            this.modal.getRoot().on(ModalEvents.hidden, function() {\n                this.modal.getRoot().animate({\"right\":\"-85%\"}, 500);\n                setTimeout(function(){\n                    modal.destroy();\n                }, 1000);\n            }.bind(this));\n            this.modal.getFooter().find('[data-action=\"save\"]').on('click', this.submitForm.bind(this));\n            this.modal.getFooter().find('[data-action=\"cancel\"]').on('click', function() {\n                modal.destroy();\n                window.location.reload();\n                // window.location.href =  window.location.href + String();\n                if (args.prevlvlid > 0 || args.prevlvlid == 0) {\n                    $.ajax({\n                        method: 'POST',\n                        url: M.cfg.wwwroot + '/local/program/ajax.php',\n                        data: {\n                            action: 'programlevelcourses',\n                            programid:args.bcid,\n                            levelid: args.levelid\n                        },\n                        success:function(resp){\n                            $('.levetabscontent_container').html(resp);\n                        }\n                    });\n                } else if(args.callback === 'program_curriculum_form' || args.callback === 'program_form') {\n                    modal.destroy();\n                } else if(args.pluginname === 'program_addlevel' || args.callback === 'program_managelevel_form') {\n                    if (args.id == 0) {\n                        modal.destroy();\n                    } else {\n                        $.ajax({\n                            method: 'POST',\n                            url: M.cfg.wwwroot + '/local/program/ajax.php',\n                            data: {\n                                action: 'programlevelcourses',\n                                programid:args.programid,\n                                levelid: args.id\n                            },\n                            success:function(resp){\n                                $('.levetabscontent_container').html(resp);\n                            }\n                        });\n                    }\n                } else {\n                    $.ajax({\n                        method: 'POST',\n                        url: M.cfg.wwwroot + '/local/program/ajax.php',\n                        data: {\n                            action: 'programlevelcourses',\n                            programid:args.programid,\n                            levelid: args.id\n                        },\n                        success:function(resp){\n                            $('.levetabscontent_container').html(resp);\n                        }\n                    });\n                }\n            });\n            this.modal.getFooter().find('[data-action=\"skip\"]').on('click', function() {\n                self.args.form_status = self.args.form_status + 1;\n                 if (args.callback == 'program_form') {\n                 }\n                var data = self.getBody();\n                data.then(function(html) {\n                    if (html === false) {\n                        self.handleFormSubmissionResponse(args);\n                        if (!$.fn.DataTable.isDataTable('#viewprograms')){\n                          $('#viewprograms').dataTable({\n                              'language': {\n                                  'paginate': {\n                                  'previous': '<',\n                                  'next': '>'\n                              },\n                          },\n                          'bInfo': false,\n                          }).destroy();\n                        }\n                        program.Datatable();\n                    }\n                });\n                modal.setBody(data);\n            });\n\n            this.modal.getRoot().on('submit', 'form', function(form) {\n                self.submitFormAjax(form, self.args);\n            });\n            this.modal.show();\n            this.modal.getRoot().animate({\"right\":\"0%\"}, 500);\n            $(\".close\").click(function(){\n                window.location.href =  window.location.href + String();\n            });\n            this.modal.show();\n            return this.modal;\n        }.bind(this));\n    };\n    /**\n     * @method getBody\n     * @private\n     * @param {object} formdata\n     * @return {Promise}\n     */\n    AjaxForms.prototype.getBody = function(formdata) {\n        if (typeof formdata === \"undefined\") {\n            formdata = {};\n        }\n        // Get the content of the modal.\n        this.args.jsonformdata = JSON.stringify(formdata);\n        return Fragment.loadFragment(this.args.component, this.args.callback, this.contextid, this.args);\n    };\n    /**\n     * @method getFooter\n     * @private\n     * @param {object} customstrings\n     * @return {Promise}\n     */\n    AjaxForms.prototype.getFooter = function(customstrings) {\n        var $style, $footer;\n        $footer = '<button id=\"id_submit\" type=\"button\" class=\"btn btn-primary before_submit\" data-action=\"save\">'+customstrings[1]+'</button>&nbsp;';\n        $footer += '<button type=\"button\" class=\"btn btn-secondary\" data-action=\"cancel\">'+customstrings[6]+'</button>&nbsp;';\n        if (this.args.form_status == 0) {\n            $style = 'style=\"display:none;\"';\n\n            $footer += '<button id=\"id_submit\" type=\"button\" class=\"btn btn-secondary\" data-action=\"skip\" '\n            + $style + '>'+customstrings[5]+'</button>&nbsp;';\n        } else {\n            $footer = '<button type=\"button\" class=\"btn btn-secondary\" data-action=\"cancel\">'+customstrings[6]+'</button>';\n        }\n        return $footer;\n    };\n    /**\n     * @method handleFormSubmissionResponse\n     * @private\n     * @param {object} args\n     * @return {Promise}\n     */\n    AjaxForms.prototype.handleFormSubmissionResponse = function(args) {\n        this.modal.destroy();\n        // We could trigger an event instead.\n        // Yuk.\n        Y.use('moodle-core-formchangechecker', function() {\n            M.core_formchangechecker.reset_form_dirty_state();\n        });\n        if (args.form_status == -2) {\n            this.modal.destroy();\n            if (args.levelid > 0 && (args.prevlvlid > 0 || args.prevlvlid == 0)) {\n                $('.programlevels #semlvlid'+args.prevlvlid).find('a').trigger('click');\n                $.ajax({\n                    method: 'POST',\n                    url: M.cfg.wwwroot + '/local/program/ajax.php',\n                    data: {\n                        action: 'programlevelcourses',\n                        programid:args.bcid,\n                        levelid: args.levelid\n                    },\n                    success:function(resp){\n                        $('.levetabscontent_container').html(resp);\n                    }\n                });\n            } else if(args.id > 0 && args.programid > 0) {\n                var pop = this.modal;\n                if (args.pluginname === 'program_addlevel') {\n                    if (args.newsemadd == 0) {\n                        window.location.href =  window.location.href + String();\n                    } else {\n                        pop.destroy();\n                        // window.location.href =  window.location.href + String();\n                        $.ajax({\n                            method: 'POST',\n                            url: M.cfg.wwwroot + '/local/program/ajax.php',\n                            data: {\n                                action: 'programlevelcourses',\n                                programid: args.programid,\n                                levelid: args.id\n                            },\n                            success:function(resp){\n                                $('.levetabscontent_container').html(resp);\n                            }\n                        });\n                    }\n                }\n            } else if(args.prevlvlid == 0 || args.prevlvlid == null) {\n                this.modal.destroy();\n                $(document).on('click', '#page-local-program-view .modal-content .modal-footer .btn-primary', function() {\n                        // this.modal.destroy();\n                        // window.location.href =  window.location.href + String();\n                    $.ajax({\n                        method: 'POST',\n                        url: M.cfg.wwwroot + '/local/program/ajax.php',\n                        data: {\n                            action: 'programlevelcourses',\n                            programid:args.bcid,\n                            levelid: args.levelid\n                        },\n                        success:function(resp){\n                            $('.levetabscontent_container').html(resp);\n                        }\n                    });\n                });\n                // window.location.href =  window.location.href + String();\n                $('.programlevels #semlvlid'+args.id).find('a').trigger('click');\n                $('#levtabcont'+args.id+' .tab-content').load(' #levtabcont'+args.id+' .tabcontent');\n            } else if (args.prevlvlid > 0 || args.prevlvlid == 0) {\n                $(document).on('click', '#page-local-program-view .modal-content .modal-footer .btn-primary', function() {\n                    $.ajax({\n                        method: 'POST',\n                        url: M.cfg.wwwroot + '/local/program/ajax.php',\n                        data: {\n                            action: 'programlevelcourses',\n                            programid:args.bcid,\n                            levelid: args.levelid\n                        },\n                        success:function(resp){\n                            $('.levetabscontent_container').html(resp);\n                        }\n                    });\n                });\n            } else {\n                $('.programlevels #semlvlid'+args.prevlvlid).trigger('click');\n                $('.programlevels #semlvlid'+args.id).trigger('click');\n            }\n        }\n        if (args.callback === 'program_form') {\n            programlastchildpopup(args);\n        }\n\n        if (args.pluginname === 'program_addlevel') {\n            window.location.reload();\n        }\n    };\n    /**\n     * @method handleFormSubmissionFailure\n     * @private\n     * @param {object} data\n     * @return {Promise}\n     */\n    AjaxForms.prototype.handleFormSubmissionFailure = function(data) {\n        // Oh noes! Epic fail :(\n        // Ah wait - this is normal. We need to re-display the form with errors!\n        this.modal.setBody(this.getBody(data));\n    };\n    /**\n     * Private method\n     *\n     * @method submitFormAjax\n     * @private\n     * @param {Event} e Form submission event.\n     * @param {object} args\n     */\n    AjaxForms.prototype.submitFormAjax = function(e, args) {\n        // We don't want to do a real form submission.\n        e.preventDefault();\n        var self = this;\n        // Convert all the form elements values to a serialised string.\n        var formData = this.modal.getRoot().find('form').serialize();\n        var methodname = args.plugintype + '_' + args.pluginname + '_submit_instance';\n        // Now we can continue...\n        var params = {};\n        params.contextid = this.contextid;\n        params.jsonformdata = JSON.stringify(formData);\n        params.form_status = args.form_status;\n\n        var promise = Ajax.call([{\n            methodname: methodname,\n            args: params\n        }]);\n\n           $(document).on('click', '#id_submit', function(){\n                   $(this).removeClass('before_submit').addClass('not-allowed');\n               });\n               // let footer = Y.one('.modal-footer');\n               // let spinner = M.util.add_spinner(Y, footer);\n               // spinner.show();\n\n        promise[0].done(function(resp){\n            self.args.form_status = resp.form_status;\n            if (resp.form_status >= 0 && resp.form_status !== false) {\n                self.args.form_status = resp.form_status;\n                self.args.id = resp.id;\n                self.handleFormSubmissionFailure();\n            } else {\n                self.args.id = resp.id;\n                self.handleFormSubmissionResponse(self.args);\n            }\n            if (args.form_status > 0) {\n                $('[data-action=\"skip\"]').css('display', 'inline-block');\n            }\n        }).fail(function(){\n            self.handleFormSubmissionFailure(formData);\n        });\n    };\n    /**\n     * This triggers a form submission, so that any mform elements can do final tricks before the form submission is processed.\n     *\n     * @method submitForm\n     * @param {Event} e Form submission event.\n     * @private\n     */\n    AjaxForms.prototype.submitForm = function(e) {\n        e.preventDefault();\n        this.modal.getRoot().find('form').submit();\n    };\n    return /** @alias module:core_group/AjaxForms */ {\n        // Public variables and functions.\n        /**\n         * Attach event listeners to initialise this module.\n         *\n         * @method init\n         * @param {object} args The CSS selector used to find nodes that will trigger this module.\n         * @return {Promise}\n         */\n        init: function(args) {\n            return new AjaxForms(args);\n        },\n        load:function(){\n\n        }\n    };\n});\n"],"names":["define","$","Str","ModalFactory","ModalEvents","Fragment","Ajax","Y","Templates","select2","program","AjaxForms","args","contextid","init","prototype","modal","header_label","self","this","callback","id","key","component","param","programname","get_strings","then","strings","create","type","types","DEFAULT","title","body","getBody","footer","getFooter","bind","setLarge","getRoot","addClass","on","hidden","animate","setTimeout","destroy","find","submitForm","window","location","reload","prevlvlid","ajax","method","url","M","cfg","wwwroot","data","action","programid","bcid","levelid","success","resp","html","pluginname","form_status","handleFormSubmissionResponse","fn","DataTable","isDataTable","dataTable","Datatable","setBody","form","submitFormAjax","show","click","href","String","formdata","jsonformdata","JSON","stringify","loadFragment","customstrings","$footer","use","core_formchangechecker","reset_form_dirty_state","trigger","pop","newsemadd","document","load","sesskey","returndata","get_string","done","programlastchildpopup","handleFormSubmissionFailure","e","preventDefault","formData","serialize","methodname","plugintype","params","promise","call","removeClass","css","fail","submit"],"mappings":"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"}