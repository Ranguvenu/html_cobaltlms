{"version":3,"file":"admissionstatus.min.js","sources":["../src/admissionstatus.js"],"sourcesContent":["/**\n * Add a create new group modal to the page.\n *\n * @module     local_admissions/confirm\n * @class      admissionstatus\n * @package\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n// 'jquery', 'core/modal_factory', 'core/str', 'core/modal_events', 'core/ajax', 'core/notification'\ndefine([\n    'jquery',\n    'local_program/jquery.dataTables',\n    'core/str',\n    'core/modal_factory',\n    'core/modal_events',\n    'core/ajax',\n    'jqueryui'\n ], function($, dataTable, Str, ModalFactory, ModalEvents, Ajax) {\n    return {\n        init: function(args) {\n            this.AssignUsers(args);\n        },\n acceptConfirm: function(args) {\n            return Str.get_strings([{\n                key: 'acceptapplication',\n                component: 'local_admissions'\n            },\n            {\n                key: 'save_continue',\n                component: 'local_admissions'\n            },\n            {\n                key: 'acceptconfirm',\n                component: 'local_admissions'\n            },\n            {\n                key: 'save_continue',\n                component: 'local_admissions'\n            },\n            {\n                key: 'deletecourseconfirm',\n                component: 'local_admissions'\n            },\n            {\n                key: 'cannotdeleteall',\n                component: 'local_admissions'\n            },\n            {\n                key: 'cannotdeletesession',\n                component: 'local_admissions'\n            },\n            {\n                key: 'cannotdeletelevel',\n                component: 'local_admissions'\n            },\n            {\n                key: 'inactiveconfirm',\n                component: 'local_admissions',\n                param: args.programname,\n            },\n            {\n                key: 'activeconfirm',\n                component: 'local_admissions',\n                param: args.programname,\n            },\n            {\n                key: 'acceptconfirm',\n                component: 'local_admissions',\n                param: args.programname,\n            },\n            {\n                key: 'rejectconfirm',\n                component: 'local_admissions'\n            },\n            ]).then(function(s) {\n                if (args.action == \"acceptconfirm\") {\n                    s[1] = s[10];\n                    var confirm = ModalFactory.types.SAVE_CANCEL;\n                 } else if (args.action == \"rejectadmission\") {\n                    s[1] = s[11];\n                    var confirm = ModalFactory.types.SAVE_CANCEL;\n                 } else if (args.action == \"acceptconfirm\") {\n                    s[1] = s[4];\n                    var confirm = ModalFactory.types.SAVE_CANCEL;\n                 } else if (args.action == \"cannotdeletelevel\") {\n                    s[1] = s[5];\n                    var confirm = ModalFactory.types.DEFAULT;\n                 } else if (args.action == \"cannotdeletesession\") {\n                    s[1] = s[6];\n                    var confirm = ModalFactory.types.DEFAULT;\n                 } else if (args.action == \"cannotdeletelevel\") {\n                    s[1] = s[7];\n                    var confirm = ModalFactory.types.DEFAULT;\n                 }else if (args.action == \"inactiveconfirm\") {\n                    s[1] = s[8];\n                    var confirm = ModalFactory.types.SAVE;\n                 }else if (args.action == \"activeconfirm\") {\n                    s[1] = s[9];\n                    var confirm = ModalFactory.types.SAVE_CANCEL;\n                 } else {\n                    s[1] = s[2];\n                    var confirm = ModalFactory.types.SAVE_CANCEL;\n                 }\n                ModalFactory.create({\n                    title: s[0],\n                    type: confirm,\n                    body: s[2]\n                }).done(function(modal) {\n                    this.modal = modal;\n                    if(args.action != \"cannotdeleteprogram\" &&\n                        args.action != \"cannotdeletesession\" &&\n                        args.action != \"cannotdeletelevel\"){\n                        modal.setSaveButtonText(s[3]);\n                    }\n                    modal.getRoot().on(ModalEvents.save, function(e) {\n                        e.preventDefault();\n                        args.confirm = true;\n                        var params = {};\n                        params.programid = args.programid;\n                        if (args.action == \"rejectadmission\") {\n                            args.action = \"reject_admission\";\n                            params.userid = args.userid;\n                            params.programid = args.programid;\n                        }\n                        if (args.action == \"acceptadmission\") {\n                            args.action = \"accept_admission\";\n                            params.action = args.action;\n                            params.context = args.context;\n                            params.id = args.id;\n                            params.programid = args.programid;\n                            params.confirm = args.confirm;\n                            params.programname = args.programname;\n                        }\n                        // let footer = Y.one('.modal-footer');\n                        let footer = Y.one('.modal-footer');\n                        // footer.setContent(String.get_string('deleting', 'block_queries'));\n                        let spinner = M.util.add_spinner(Y, footer);\n                        spinner.show();\n                        var promise = Ajax.call([{\n                            methodname: 'local_admissions_' + args.action,\n                            args: params\n                        }]);\n                        promise[0].done(function() {\n                            if(args.action == \"deletestream\"){\n                                window.location.href = M.cfg.wwwroot + '/local/admissions/view.php';\n                            }else if(args.action == \"deletesession\" ||\n                                args.action == \"acceptconfirm\" ||\n                                args.action == \"activeconfirm\" ||\n                                args.action == \"inactiveconfirm\"){\n                                modal.hide();\n                                window.location.reload();\n                            } else {\n                                modal.hide();\n                                window.location.reload();\n                            }\n                        }).fail(function() {\n                            // do something with the exception\n                        });\n                    }.bind(this));\n                    modal.show();\n                }.bind(this));\n            }.bind(this));\n        },\n    };\n });\n"],"names":["define","$","dataTable","Str","ModalFactory","ModalEvents","Ajax","init","args","AssignUsers","acceptConfirm","get_strings","key","component","param","programname","then","s","action","confirm","types","SAVE_CANCEL","DEFAULT","SAVE","create","title","type","body","done","modal","setSaveButtonText","getRoot","on","save","e","preventDefault","params","programid","userid","context","id","footer","Y","one","M","util","add_spinner","show","call","methodname","window","location","href","cfg","wwwroot","hide","reload","fail","bind","this"],"mappings":"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"}