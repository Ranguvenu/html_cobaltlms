define("local_costcenter/form-options-selector",["jquery","core/ajax","core/templates","core/str"],(function($,Ajax,Templates,Str){return{processResults:function(selector,results){var options=[];return $.isArray(results)?($.each(results,(function(index,option){options.push({value:option.id,label:option._label})})),options):results},transport:function(selector,query,success,failure){var contextid=parseInt($(selector).data("contextid"),10),action=$(selector).data("action"),pluginclass=$(selector).data("pluginclass"),formoptions=$(selector).data("options");if(Str.get_strings([{key:"selectdept",component:"local_courses"},{key:"selectsubdept",component:"local_courses"},{key:"selectcat",component:"local_courses"},{key:"select_batch",component:"local_program"},{key:"select_curriculum_list",component:"local_program"},{key:"selectcourse",component:"local_courses"}]).then((function(s){s[0];var subdeptartmentselect="<span><span>"+s[1]+"</span></span>",categoryselect="<span><span>"+s[2]+"</span></span>",batchselect="<span><span>"+s[3]+"</span></span>",curriculumselect="<span><span>"+s[4]+"</span></span>",courseselect="<span><span>"+s[5]+"</span></span>";"costcenter_courseid_selector"===action&&(formoptions.courseid=$("#id_coursesid").val(),$("#id_coursesid").on("change",(function(){$("#id_coursesid").val()}))),"costcenter_teacherid_selector"===action&&(formoptions.teacherid=$("#id_teacherid").val()),"costcenter_program_selector"===action&&(formoptions.programid=$("#id_program").val()),"program_level_selector"===action&&(formoptions.levelid=$("#id_semester").val()),"costcenter_building_selector"===action&&(formoptions.building=$("#id_building").val()),"costcenter_room_selector"===action&&(formoptions.room=$("#id_room").val()),"costcenter_departments_selector"!==action&&"costcenter_subdepartment_selector"!==action&&"costcenter_courses_selector"!==action||($("#id_open_departmentid").on("change",(function(){var subdept=$("#id_open_subdepartment").val();parseInt(subdept)>0&&($("#id_open_subdepartment").html(""),$(".subdepartmentselect .form-autocomplete-selection").html(subdeptartmentselect));var courses=$("#id_course").val();parseInt(courses)>0&&($("#id_course").html(""),$(".courseselect .form-autocomplete-selection").html(courseselect))})),formoptions.departmentid=$("#id_open_departmentid").val(),formoptions.subdepartment=$("#id_open_subdepartment").val(),formoptions.course=$("#id_course").val()),"costcenter_organisation_selector"===action?$("#id_open_costcenterid").on("change",(function(){$("#id_open_departmentid").val();var category=$("#id_category").val();parseInt(category)>0&&($("#id_category").html(""),$(".categoryselect .form-autocomplete-selection").html(categoryselect));var batch=$("#id_batchid").val();parseInt(batch)>0&&($("#id_batchid").html(""),$(".batchselect .form-autocomplete-selection").html(batchselect));var curriculum=$("#id_curriculumid").val();parseInt(curriculum)>0&&($("#id_curriculumid").html(""),$(".curriculumselect .form-autocomplete-selection").html(curriculumselect));var courses=$("#id_course").val();parseInt(courses)>0&&($("#id_course").html(""),$(".courseselect .form-autocomplete-selection").html(courseselect))})):"costcenter_department_selector"!==action&&"costcenter_subdepartment_selector"!==action&&"costcenter_batch_selector"!==action&&"costcenter_curriculum_selector"!==action&&"costcenter_courses_selector"!==action||($("#id_open_departmentid").on("change",(function(){var subdept=$("#id_open_subdepartment").val();parseInt(subdept)>0&&($("#id_open_subdepartment").html(""),$(".subdepartmentselect .form-autocomplete-selection").html(subdeptartmentselect));var category=$("#id_category").val();parseInt(category)>0&&($("#id_category").html(""),$(".categoryselect .form-autocomplete-selection").html(categoryselect));var batch=$("#id_batchid").val();parseInt(batch)>0&&($("#id_batchid").html(""),$(".batchselect .form-autocomplete-selection").html(batchselect));var curriculum=$("#id_curriculumid").val();parseInt(curriculum)>0&&($("#id_curriculumid").html(""),$(".curriculumselect .form-autocomplete-selection").html(curriculumselect));var courses=$("#id_course").val();parseInt(courses)>0&&($("#id_course").html(""),$(".courseselect .form-autocomplete-selection").html(courseselect))})),$("#id_open_subdepartment").on("change",(function(){var category=$("#id_category").val();parseInt(category)>0&&($("#id_category").html(""),$(".categoryselect .form-autocomplete-selection").html(categoryselect));var batch=$("#id_batchid").val();parseInt(batch)>0&&($("#id_batchid").html(""),$(".batchselect .form-autocomplete-selection").html(batchselect));var curriculum=$("#id_curriculumid").val();parseInt(curriculum)>0&&($("#id_curriculumid").html(""),$(".curriculumselect .form-autocomplete-selection").html(curriculumselect));var courses=$("#id_course").val();parseInt(courses)>0&&($("#id_course").html(""),$(".courseselect .form-autocomplete-selection").html(courseselect))})))})),"costcenter_department_selector"===action||"costcenter_subdepartment_selector"===action||"costcenter_teacherid_selector"===action||"costcenter_organisation_selector"===action||"costcenter_role_selector"===action||"program_level_selector"===action||"costcenter_room_selector"===action)formoptions.roleid=$("#id_roleid").val(),formoptions.parentid=$('[data-class="'+$(selector).data("parentclass")+'"]').val();else if("costcenter_category_selector"===action||"costcenter_batch_selector"===action||"costcenter_curriculum_selector"===action||"costcenter_courses_selector"===action||"costcenter_program_selector"===action||"costcenter_role_selector"===action||"costcenter_element_selector"===action){var parentid=$('[data-class="'+$(selector).data("parentclass")+'"]').val();null==parentid&&formoptions.parentid>0||(formoptions.parentid=parentid),formoptions.organisationid=$("#id_open_costcenterid").val(),formoptions.roleid=$("#id_roleid").val(),formoptions.departmentid=$("#id_open_departmentid").val(),formoptions.subdepartment=$("#id_open_subdepartment").val(),formoptions.batchid=$("#id_batchid").val(),formoptions.curriculumid=$("#id_curriculumid").val(),formoptions.course=$("#id_course").val()}formoptions=JSON.stringify(formoptions),Ajax.call([{methodname:"local_costcenter_form_option_selector",args:{query:query,context:{contextid:contextid},action:action,options:formoptions,searchanywhere:!0,page:0,perpage:101,pluginclass:pluginclass}}])[0].then((function(results){results=$.parseJSON(results);var promises=[],i=0;return"local_costcenter/form-option-selector-suggestion",results.length<=100?($.each(results,(function(index,option){$("#id_roleid").on("change",(function(){$("#id_roleid").val()==option.id&&("orgadmin"==option.shortname?($("#fitem_id_open_departmentid").hide(),$("#fitem_id_open_subdepartment").hide()):($("#fitem_id_open_departmentid").show(),$("#fitem_id_open_subdepartment").show()))}));var ctx=option;ctx.hasidentity=!0,ctx.identity=[].join(", "),promises.push(Templates.render("local_costcenter/form-option-selector-suggestion",ctx))})),$.when.apply($.when,promises).then((function(){var args=arguments;$.each(results,(function(index,option){option._label=args[i],i++})),success(results)}))):Str.get_string("toomanyoptionstoshow","local_costcenter",">100").then((function(toomanyoptionstoshow){success(toomanyoptionstoshow)}))})).fail(failure)}}}));

//# sourceMappingURL=form-options-selector.min.js.map